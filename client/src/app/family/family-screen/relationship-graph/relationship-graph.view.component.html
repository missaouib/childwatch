<md-card>
  <svg width="100%" height="100%" #svgEle>
    <line *ngFor="let rel of relationships; let i = index; trackBy: rel?.id" [attr.x1]="rel.source.x" [attr.x2]="rel.target.x"
      stroke="black" [attr.y1]="rel.source.y" [attr.y2]="rel.target.y" class="rel-highlight">
    </line>

    <!-- Thick invisible line making it easy to click -->
    <line *ngFor="let rel of relationships; let i = index; trackBy: rel?.id" (click)="relationshipSelected(rel)" [attr.x1]="rel.source.x"
      [attr.x2]="rel.target.x" [attr.y1]="rel.source.y" [attr.y2]="rel.target.y" style="stroke-width: 8; opacity: 0; stroke: grey;">
    </line>

    <!--
      Create a group to contain each entity (circle and name).
      Translate is applied here so that both circle and text are kept together
    -->
    <g (click)="entitySelected(entity)" *ngFor="let entity of entities; trackBy: entity?.id" [attr.transform]="'translate(' + entity.x +', ' + entity.y + ')'">
      
      <!-- 
          Yes, the nested group is needed. The translation on the outter group is overridden, 
          if placed hoverstate is placed outer group.
      -->
      <g [@hoverState]="hoverEntity === entity ? 'on' : 'off'">

        <circle (mouseout)="hoverEntity = undefined" (mouseover)="mouseOver(entity)" [attr.r]="10" [style.fill-opacity]="1"></circle>

        <!-- entity name -->
        <text [@hoverText]="hoverEntity === entity ? 'on' : 'off'" dx="0" dy="1.8em" font-size="16px" text-anchor="middle">
          {{entity.displayName}}
        </text>

      </g>
    </g>
  </svg>
</md-card>
<style>
  md-card {
    height: 100%;
  }

  g text {
    text-shadow: 1px 1px 1px #f8f8f7;
  }
</style>