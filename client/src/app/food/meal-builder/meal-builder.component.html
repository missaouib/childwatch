
<div class="card">
	<div class="card-header">
		<div class="card-title">
			<h3 *ngIf="!editing" (click)="editing = !editing">
				<span class="pull-right" >
					<a><small class="text-primary"><i class="fa fa-pencil"></i> Edit </small></a>
					<a><small class="text-danger"><i class="fa fa-trash"></i> Delete </small></a>
				</span>
				<em>{{ mealForm.get('name').value || "New Meal" }}</em>
				<small>{{ mealForm.get('type').value || "Type"}}</small>
			</h3>
		
			<form *ngIf="editing" novalidate [formGroup]="mealForm" >
				<div class="row">
					<div class="form-group col-sm-2">
						<label for="type">Type</label>
						<select #type class="form-control" formControlName="type" (blur)="editing = (mealForm.valid)? !editing : editing">
							<option value="BREAKFAST">Breakfast</option>
							<option value="AM_SNACK">AM Snack</option>
							<option value="LUNCH">Lunch</option>
							<option value="PM_SNACK">PM Snack</option>
							<option value="DINNER">Dinner</option>
						</select>
						<small class="text-danger" *ngIf="mealForm.get('type').hasError('required')">Type is required</small>
					</div>
		
					<div class="form-group col-sm-4">
						<label for="name"></label>
						<input #name class="form-control" placeholder="Meal Name" formControlName="name" (blur)="editing = (mealForm.valid)? !editing : editing"/> 
						<small class="text-danger" *ngIf="mealForm.get('name').hasError('required')">Name is required</small>
					</div>		
				</div>				
			</form>
		</div>
	
	</div>
	
	<div class="card-content">
			<h5>Age Group</h5>
				<div class="btn-group">
	  				<label *ngFor="let grp of ['AGE_0_5MO', 'AGE_6_11MO', 'AGE_1_2YR', 'AGE_3_5YR', 'AGE_6_12YR', 'AGE_13_18YR', 'AGE_ADULT' ]" 
	  					   class="btn"
	  					   [class.btn-warning]="grp === currentAgeGroup" (click)="activateTab(grp)">
	  					{{grp.substring(4).replace('_','-').replace('MO',' MO').replace('YR',' YR')}}
	  				</label>
				</div>	
			<a (click)="showGuidance = !showGuidance"><small class="text-primary"><i class="fa fa-book"></i> Guidance </small></a>					
			<hr />
			
			<alert type="local" *ngIf="showGuidance && mealForm.valid">
				<h4 class="alert-heading">Guidance for {{currentAgeGroup.substring(4).replace('_','-').replace('MO',' MO').replace('YR',' YR')}} {{mealForm.get('type').value.toLowerCase() }}</h4>
				<p>Can we try some other colours maybe make it original could you rotate the picture to show the other side of the room? try making it a bit less blah jazz it up a little that's great, but can you make it work for ie 2 please. That's great, but we need to add this 2000 line essay can you put "find us on facebook" by the facebook logo? we don't need a contract, do we give us a complimentary logo along with the website is this the best we can do, so i love it, but can you invert all colors?. That's great, but can you make it work for ie 2 please I have an awesome idea for a startup, i need you to build it for me we are a big name to have in your portfolio, could you rotate the picture to show the other side of the room? I like it, but can the snow look a little warmer will royalties in the company do instead of cash we need more images of groups of people having non-specific types of fun.</p>
				<p>Can you turn it around in photoshop so we can see more of the front. Can you make it look like this clipart i found try making it a bit less blah yet I really think this could go viral anyway, you are the designer, you know what to do can you make the blue bluer? nor I want you to take it to the next level. I need a website. How much will it cost the website doesn't have the theme i was going for, what you've given us is texty, we want sexy so can you lower the price for the website? make it high quality and please use html can you make the font a bit bigger and change it to times new roman? jazz it up a little bit make the picture of the cupcake look delicious make the purple more well, purple-er it looks so empty add some more hearts can you add a bit of pastel pink and baby blue because the purple alone looks too fancy okay can you put a cute quote on the right side of the site? oh no it looks messed up! i think we need to start from scratch that sandwich needs to be more playful. That sandwich needs to be more playful theres all this spanish text on my site. This red is too red the website doesn't have the theme i was going for, yet the target audience is makes and famles aged zero and up concept is bang on, but can we look at a better execution I have printed it out, but the animated gif is not moving the hair is just too polarising. You are lucky to even be doing this for us I know somebody who can do this for a reasonable cost, or I got your invoice...it seems really high, why did you charge so much. I got your invoice...it seems really high, why did you charge so much other agencies charge much lesser needs to be sleeker, so try making it a bit less blah the flier should feel like a warm handshake, and can you turn it around in photoshop so we can see more of the front, we are a big name to have in your portfolio.</p> 
			</alert>
			
			<alert *ngFor="let violation of rulesViolationsForCurrentAgeGroup()" [type]="(violation.severity === 'FAIL') ? 'danger' : (violation.severity === 'FAIL') ? 'warning' : 'info'">
				<h4 class="alert-heading">
					<i class="fa" 
					   [class.fa-exclamation-triangle]="violation.severity === 'FAIL'"
					   [class.fa-exclamation-circle]="violation.severity === 'WARN'"
					   [class.fa-info-circle]="violation.severity === 'INFO'"
					   [class.fa-question-circle]="violation.severity === 'UNKNOWN'"></i> 
					   {{violation.severity}} 
				</h4>
				   
				   <p>{{violation.message}}</p>		
			</alert>
						
			<hr *ngIf="rulesViolationsForCurrentAgeGroup().length > 0" />

			<div *ngFor="let mealFoodItem of foodItemsForCurrentAgeGroup()" class="panel panel-default">
				<form novalidate [formGroup]="foodItemForm[currentAgeGroup].controls[ mealFoodItem.id ]">
					<div class="row">
						<span class="col-sm-1">
							<i class="cw-icon" style="font-size: 5em;" [ngClass]="mealFoodItem.foodComponent.icon ? mealFoodItem.foodComponent.icon : 'icon-food'"></i>
						</span>					
				    
						<span class="col-xs-12 col-sm-6">
							<label>{{mealFoodItem.foodComponent.description}}</label>
							<input class="form-control" formControlName="description"
							       [typeahead]="foodForComponent( mealFoodItem.foodComponent )"
							       (typeaheadOnSelect)="foodItemForm[currentAgeGroup].controls[mealFoodItem.id].patchValue( {foodItem: $event.item } )"
								   typeaheadOptionField="description" typeaheadOptionsLimit="15" />
						</span>
						<span class="col-xs-12 col-sm-2 "> 
							<label>Quantity</label> 
							<input class="form-control" formControlName="quantity" value="0">
						</span> 
						<span class="col-xs-12 col-sm-2"> 
							<label>Units</label> 
							<select class="form-control" formControlName="unit">
								<option value="each">each</option>
								<option value="oz">oz</option>
								<option value="slice">slice</option>
								<option value="lbs">lbs</option>
							</select>
						</span> 
						<span class="col-sm-1">
							<i class="text-danger pull-right fa fa-close" (click)="removeComponent(mealFoodItem)"></i>
						</span>
					</div>
				</form>
			</div>
											

			<div *ngIf="foodItemsForCurrentAgeGroup().length == 0">
				<strong>No food items found for age group {{currentAgeGroup.substring(4).replace('_','-').replace('MO',' MO').replace('YR',' YR')}}</strong>
			</div>
	</div>
	
	<div class="card-footer">
		<hr *ngIf="foodItemsForCurrentAgeGroup().length > 0" />

		<div class="btn-group" dropdown *ngIf="mealForm.valid && !editing">
			<a dropdownToggle class="dropdown-toggle"><i
				class="text-primary fa fa-plus"></i> Add Food Items</a>
			<ul *dropdownMenu class="dropdown-menu" role="menu">
			
				<ng-template ngFor let-top [ngForOf]="foodComponents">
					<li class="dropdown-header"><strong>{{top.description}}</strong></li>
					<li role="menuitem" *ngFor="let comp of top.children">
						<a class="dropdown-item" (click)="addComponent(comp)">{{comp.description}}</a>
					</li>
				</ng-template>
			</ul>
		</div>

		<div *ngIf="foodItemsForCurrentAgeGroup().length > 0"
			class="btn-group" dropdown [autoClose]="true" container="body"
			style="margin-left: 10px">
			<a dropdownToggle class="dropdown-toggle">
				<i class="text-primary fa fa-copy"></i> Copy To...</a>
			<ul *dropdownMenu class="dropdown-menu" role="menu">
				<li *ngIf="currentAgeGroup !== 'AGE_0_5MO'" role="menuitem"><a
					class="dropdown-item" (click)="copyTo('AGE_0_5MO')">0-5 MO</a></li>
				<li *ngIf="currentAgeGroup !== 'AGE_6_11MO'" role="menuitem"><a
					class="dropdown-item" (click)="copyTo('AGE_6_11MO')">6-11 MO</a></li>
				<li *ngIf="currentAgeGroup !== 'AGE_1_2YR'" role="menuitem"><a
					class="dropdown-item" (click)="copyTo('AGE_1_2YR')">1-2 YR</a></li>
				<li *ngIf="currentAgeGroup !== 'AGE__5YR'" role="menuitem"><a
					class="dropdown-item" (click)="copyTo('AGE_3_5YR')">3-5 YR</a></li>
				<li *ngIf="currentAgeGroup !== 'AGE_6_12YR'" role="menuitem"><a
					class="dropdown-item" (click)="copyTo('AGE_6_12YR')">6-12 YR</a></li>
				<li *ngIf="currentAgeGroup !== 'AGE_13_18YR'" role="menuitem"><a
					class="dropdown-item" (click)="copyTo('AGE_13_18YR')">13-18
						YR</a></li>
				<li *ngIf="currentAgeGroup !== 'AGE_ADULT'" role="menuitem"><a
					class="dropdown-item" (click)="copyTo('AGE_ADULT')">ADULT</a></li>
				<li class="divider dropdown-divider"></li>
				<li role="menuitem"><a class="dropdown-item"
					(click)="copyTo('ALL',currentAgeGroup)">ALL</a></li>
			</ul>
		</div>

	</div>
</div>


